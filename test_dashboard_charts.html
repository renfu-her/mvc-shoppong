<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Charts Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid p-4">
        <h1>ECharts 日期區間功能測試</h1>
        
        <!-- Date Range Controls -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3">
                    <div>
                        <h5 class="mb-0">Commerce Insights</h5>
                        <small class="text-muted">Analysis period · <span id="current-range-label">Jan 15 - Jan 29, 2024</span></small>
                    </div>
                    <div class="d-flex align-items-center gap-2">
                        <!-- Preset buttons -->
                        <div class="btn-group btn-group-sm" role="group">
                            <button type="button" class="btn btn-outline-secondary" data-days="7">7 Days</button>
                            <button type="button" class="btn btn-outline-secondary active" data-days="14">14 Days</button>
                            <button type="button" class="btn btn-outline-secondary" data-days="30">30 Days</button>
                            <button type="button" class="btn btn-outline-secondary" data-days="90">90 Days</button>
                        </div>
                        <!-- Date range picker -->
                        <div class="input-group input-group-sm" style="width: 280px;">
                            <input type="date" id="start-date" class="form-control" placeholder="Start date">
                            <span class="input-group-text">to</span>
                            <input type="date" id="end-date" class="form-control" placeholder="End date">
                            <button class="btn btn-primary" type="button" id="update-range">Update</button>
                        </div>
                        <!-- Loading indicator -->
                        <div id="chart-loading" class="spinner-border spinner-border-sm text-primary d-none" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Row -->
        <div class="row">
            <div class="col-lg-7 mb-4">
                <div class="card h-100">
                    <div class="card-header">
                        <h6 class="mb-0">Order Momentum</h6>
                    </div>
                    <div class="card-body">
                        <div id="order-trend-chart" style="height: 320px;"></div>
                    </div>
                </div>
            </div>
            <div class="col-lg-5 mb-4">
                <div class="card h-100">
                    <div class="card-header">
                        <h6 class="mb-0">Top Products by Units</h6>
                    </div>
                    <div class="card-body">
                        <div id="product-performance-chart" style="height: 320px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script>
        // 測試資料
        const testOrderData = [
            { date: '2024-01-15', orders: 5, revenue: 1250.00 },
            { date: '2024-01-16', orders: 8, revenue: 2100.50 },
            { date: '2024-01-17', orders: 3, revenue: 800.25 },
            { date: '2024-01-18', orders: 12, revenue: 3200.75 },
            { date: '2024-01-19', orders: 7, revenue: 1850.00 },
            { date: '2024-01-20', orders: 15, revenue: 4500.00 },
            { date: '2024-01-21', orders: 9, revenue: 2350.30 }
        ];

        const testProductData = [
            { name: 'iPhone 15 Pro', units: 25, revenue: 24750.00 },
            { name: 'MacBook Air M2', units: 18, revenue: 21600.00 },
            { name: 'AirPods Pro', units: 45, revenue: 11250.00 },
            { name: 'iPad Air', units: 12, revenue: 7200.00 },
            { name: 'Apple Watch', units: 22, revenue: 8800.00 }
        ];

        // 測試 JavaScript 功能
        console.log('ECharts loaded:', typeof echarts !== 'undefined');
        console.log('Test order data:', testOrderData);
        console.log('Test product data:', testProductData);

        // 模擬日期區間功能測試
        document.addEventListener('DOMContentLoaded', function() {
            // 設定初始日期
            document.getElementById('start-date').value = '2024-01-15';
            document.getElementById('end-date').value = '2024-01-29';
            
            // 設定今天為最大日期
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('end-date').setAttribute('max', today);

            // 測試按鈕事件
            document.querySelectorAll('[data-days]').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('[data-days]').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    console.log('Selected days:', this.getAttribute('data-days'));
                });
            });

            // 測試更新按鈕
            document.getElementById('update-range').addEventListener('click', function() {
                const startDate = document.getElementById('start-date').value;
                const endDate = document.getElementById('end-date').value;
                console.log('Custom date range:', startDate, 'to', endDate);
                
                if (!startDate || !endDate) {
                    alert('請選擇開始和結束日期');
                    return;
                }
                
                if (new Date(startDate) > new Date(endDate)) {
                    alert('開始日期不可晚於結束日期');
                    return;
                }
                
                // 模擬載入
                document.getElementById('chart-loading').classList.remove('d-none');
                setTimeout(() => {
                    document.getElementById('chart-loading').classList.add('d-none');
                    document.getElementById('current-range-label').textContent = 
                        `${startDate} - ${endDate}`;
                }, 1000);
            });

            console.log('✅ 日期區間功能測試完成');
            console.log('✅ UI 控件正常運作');
            console.log('✅ 事件監聽器已設定');
        });
    </script>
</body>
</html>
